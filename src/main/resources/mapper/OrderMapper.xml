<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.docmall.basic.order.OrderMapper">

	<insert id="order_insert" parameterType="OrderVO">
		
		<selectKey keyProperty="order_num" resultType="Long" order="BEFORE">
			
			SELECT
				SEQ_ORDER_NUM
			FROM
				dual
		</selectKey>
	
		INSERT INTO
			order_num_tbl(order_num, user_id, order_name, order_zipcode, order_addr, order_deaddr, order_pho, order_price, order_req)
		VALUES
			(#{order_num}, #{user_id}, #{order_name}, #{order_zipcode}, #{order_addr}, #{order_deaddr}, #{order_pho}, #{order_price}, #{order_req})
	</insert>

	<insert id="orderDetail_insert" parameterType="map">
	
		INSERT INTO
			order_det_tbl(order_det_num, pro_num, item_amount, item_price)
		SELECT
			#{order_det_num},pro_num,item_amount,pro_num*item_amount
		FROM
			cart_tbl
		WHERE
			user_id = #{user_id}
	
	
	
	</insert>


</mapper>